module.exports=[20537,a=>{"use strict";a.s(["default",()=>l]);var b=a.i(87924),c=a.i(31626),d=a.i(72131),e=a.i(49975),f=a.i(50944),g=a.i(6704),h=a.i(31161);a.i(69387);var i=a.i(60574),j=a.i(16121);let k=({id:a,name:c,type:d,placeholder:e,value:f,onChange:g,required:h=!1,pattern:i,maxLength:j,label:k,children:l,disabled:m=!1})=>(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:a,children:k}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{className:`shadow-sm appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-10 ${m?"bg-gray-100 cursor-not-allowed":""}`,id:a,name:c,type:d,placeholder:e,value:f,onChange:g,required:h,pattern:i,maxLength:j,disabled:m}),l]})]});function l(){let{user:a,loading:l}=(0,e.useAuth)(),m=(0,f.useRouter)(),[n,o]=(0,d.useTransition)(),[p,q]=(0,d.useState)(!0),[r,s]=(0,d.useState)({nombre:"",apellido:"",dni:"",telefonoPrincipal:"",telefonoSecundario:"",direccion:"",barrio:"",nombreContactoEmergencia:"",telefonoContactoEmergencia:""});(0,d.useEffect)(()=>{if(!l){if(!a)return void m.replace("/login");(async()=>{let b=(0,i.doc)(j.db,"users",a.uid),c=await (0,i.getDoc)(b);if(c.exists()&&c.data().profileCompleted)g.toast.success("Tu perfil ya está completo.",{duration:2e3}),m.replace("/");else{let b=c.data()||{},[d,...e]=a.displayName?.split(" ")||["",""];s(a=>({...a,nombre:b.nombre||d,apellido:b.apellido||e.join(" "),...b})),q(!1)}})()}},[a,l,m]);let t=a=>{let{name:b,value:c}=a.target;(!("dni"===b||b.includes("telefono"))||!c||/^[0-9]+$/.test(c))&&s(a=>({...a,[b]:c}))},u=async b=>{if(b.preventDefault(),!a)return g.toast.error("Tu sesión ha expirado. Por favor, inicia sesión de nuevo."),m.push("/login");o(async()=>{let b=await (0,h.completarPerfil)(a.uid,r);b.success?(g.toast.success("¡Perfil completado con éxito! Redirigiendo..."),setTimeout(()=>{m.push("admin"===b.role?"/admin":"/")},1500)):g.toast.error(b.error||"Hubo un error al guardar tu perfil.")})};return l||p?(0,b.jsxs)("div",{className:"jsx-3a3b54fd29b3701c flex justify-center items-center h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"jsx-3a3b54fd29b3701c loader"})," ",(0,b.jsx)(c.default,{id:"3a3b54fd29b3701c",children:".loader.jsx-3a3b54fd29b3701c{border:4px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;width:40px;height:40px;animation:1s linear infinite spin}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,b.jsx)(g.Toaster,{position:"bottom-center"}),(0,b.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-2xl",children:[(0,b.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Completa tu Perfil"}),(0,b.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"¡Casi listo! Solo necesitamos un par de datos más para continuar."})]}),(0,b.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-2xl",children:(0,b.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,b.jsxs)("form",{onSubmit:u,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(k,{id:"nombre",name:"nombre",type:"text",label:"Nombre",placeholder:"Juan",value:r.nombre,onChange:t,required:!0}),(0,b.jsx)(k,{id:"apellido",name:"apellido",type:"text",label:"Apellido",placeholder:"Pérez",value:r.apellido,onChange:t,required:!0})]}),(0,b.jsx)(k,{id:"dni",name:"dni",type:"tel",label:"DNI",placeholder:"Sin puntos ni espacios",value:r.dni,onChange:t,required:!0,maxLength:"8"}),(0,b.jsx)(k,{id:"direccion",name:"direccion",type:"text",label:"Dirección",placeholder:"Av. Siempreviva 742",value:r.direccion,onChange:t,required:!0}),(0,b.jsx)(k,{id:"barrio",name:"barrio",type:"text",label:"Barrio",placeholder:"Springfield",value:r.barrio,onChange:t,required:!0}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(k,{id:"telefonoPrincipal",name:"telefonoPrincipal",type:"tel",label:"Teléfono Principal",placeholder:"1122334455",value:r.telefonoPrincipal,onChange:t,required:!0}),(0,b.jsx)(k,{id:"telefonoSecundario",name:"telefonoSecundario",type:"tel",label:"Teléfono Secundario",placeholder:"(Opcional)",value:r.telefonoSecundario,onChange:t})]}),(0,b.jsx)("hr",{className:"my-6"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Contacto de Emergencia"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsx)(k,{id:"nombreContactoEmergencia",name:"nombreContactoEmergencia",type:"text",label:"Nombre",placeholder:"Jane Doe",value:r.nombreContactoEmergencia,onChange:t,required:!0}),(0,b.jsx)(k,{id:"telefonoContactoEmergencia",name:"telefonoContactoEmergencia",type:"tel",label:"Teléfono",placeholder:"1188776655",value:r.telefonoContactoEmergencia,onChange:t,required:!0})]}),(0,b.jsx)("div",{children:(0,b.jsx)("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Guardando...":"Guardar y Finalizar"})})]})})})]})}}];

//# sourceMappingURL=src_app_completar-perfil_page_e260dcfa.js.map
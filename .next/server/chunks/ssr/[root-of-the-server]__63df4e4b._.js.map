{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/lib/firebaseAdmin.js"],"sourcesContent":["\nimport admin from 'firebase-admin';\n\n// Esta es la forma correcta y recomendada de inicializar el Admin SDK.\n// Se asegura de que la inicialización solo ocurra una vez.\nif (!admin.apps.length) {\n  try {\n    // Al llamar a initializeApp() sin argumentos, el SDK buscará automáticamente\n    // las credenciales del entorno (Application Default Credentials), que es\n    // la práctica recomendada en entornos de Google Cloud como Firebase Studio.\n    admin.initializeApp();\n  } catch (error) {\n    console.error('Error en la inicialización de Firebase Admin SDK:', error);\n  }\n}\n\n/**\n * Verifica la cookie de sesión de Firebase y devuelve el UID del usuario.\n * @param {string} sessionCookie La cadena de la cookie de sesión.\n * @returns {Promise<string|null>} El UID del usuario o null si la cookie no es válida.\n */\nexport async function getUserIdFromSession(sessionCookie) {\n  if (!sessionCookie) {\n    return null;\n  }\n  try {\n    // Verificamos la cookie de sesión. El `true` comprueba si ha sido revocada.\n    const decodedClaims = await admin.auth().verifySessionCookie(sessionCookie, true);\n    return decodedClaims.uid;\n  } catch (error) {\n    // La cookie de sesión es inválida o ha expirado.\n    console.error('Error al verificar la cookie de sesión:', error.code);\n    return null;\n  }\n}\n\n// Exportamos la instancia de admin ya inicializada.\nexport default admin;\n"],"names":[],"mappings":";;;;;;AACA;;AAEA,uEAAuE;AACvE,2DAA2D;AAC3D,IAAI,CAAC,sIAAK,CAAC,IAAI,CAAC,MAAM,EAAE;IACtB,IAAI;QACF,6EAA6E;QAC7E,yEAAyE;QACzE,4EAA4E;QAC5E,sIAAK,CAAC,aAAa;IACrB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qDAAqD;IACrE;AACF;AAOO,eAAe,qBAAqB,aAAa;IACtD,IAAI,CAAC,eAAe;QAClB,OAAO;IACT;IACA,IAAI;QACF,4EAA4E;QAC5E,MAAM,gBAAgB,MAAM,sIAAK,CAAC,IAAI,GAAG,mBAAmB,CAAC,eAAe;QAC5E,OAAO,cAAc,GAAG;IAC1B,EAAE,OAAO,OAAO;QACd,iDAAiD;QACjD,QAAQ,KAAK,CAAC,2CAA2C,MAAM,IAAI;QACnE,OAAO;IACT;AACF;uCAGe,sIAAK","debugId":null}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/components/PrivateRoute.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/components/PrivateRoute.js <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/components/PrivateRoute.js <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsS,GACnU,oEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/components/PrivateRoute.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/components/PrivateRoute.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/components/PrivateRoute.js\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkR,GAC/S,gDACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/mis-turnos/page.js"],"sourcesContent":["\nimport { cookies } from 'next/headers';\nimport { redirect } from 'next/navigation';\nimport admin from '@/lib/firebaseAdmin';\nimport { getUserIdFromSession } from '@/lib/firebaseAdmin';\nimport PrivateRoute from '@/app/components/PrivateRoute';\nimport Footer from '@/app/components/Footer';\nimport { FiClock, FiCheckCircle, FiXCircle, FiCalendar, FiSun, FiMoon, FiScissors, FiWind } from 'react-icons/fi';\n\n// Función para obtener los turnos y enriquecerlos con los datos de la mascota\nasync function getUserTurnos(userId) {\n    if (!userId) return [];\n\n    const firestore = admin.firestore();\n    try {\n        const turnosSnap = await firestore.collection('turnos')\n            .where('clienteId', '==', userId)\n            .orderBy('createdAt', 'desc')\n            .get();\n\n        if (turnosSnap.empty) {\n            return [];\n        }\n\n        // Usamos Promise.all para hacer las búsquedas de mascotas en paralelo\n        const turnosEnriquecidos = await Promise.all(turnosSnap.docs.map(async (doc) => {\n            const turno = doc.data();\n            let mascotaNombre = 'Mascota no encontrada';\n\n            const mascotaSnap = await firestore.collection('users').doc(userId).collection('mascotas').doc(turno.mascotaId).get();\n            if (mascotaSnap.exists) {\n                mascotaNombre = mascotaSnap.data().nombre;\n            }\n\n            return {\n                id: doc.id,\n                ...turno,\n                mascotaNombre,\n                // Convertir la fecha a un formato legible\n                fechaFormateada: new Date(turno.fecha).toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })\n            };\n        }));\n\n        return turnosEnriquecidos;\n\n    } catch (error) {\n        console.error(\"Error al obtener los turnos en el servidor:\", error);\n        return [];\n    }\n}\n\n// Componente para el badge de estado\nfunction EstadoBadge({ estado }) {\n    const baseClasses = \"px-3 py-1 text-xs font-semibold rounded-full inline-flex items-center\";\n    const styles = {\n        pendiente: { icon: <FiClock className=\"mr-2\" />, classes: \"bg-yellow-100 text-yellow-800\" },\n        confirmado: { icon: <FiCheckCircle className=\"mr-2\" />, classes: \"bg-green-100 text-green-800\" },\n        cancelado: { icon: <FiXCircle className=\"mr-2\" />, classes: \"bg-red-100 text-red-800\" },\n        completado: { icon: <FiCheckCircle className=\"mr-2\" />, classes: \"bg-blue-100 text-blue-800\" },\n    };\n    const style = styles[estado] || styles.pendiente;\n\n    return (\n        <div className={`${baseClasses} ${style.classes}`}>\n            {style.icon}\n            {estado.charAt(0).toUpperCase() + estado.slice(1)}\n        </div>\n    );\n}\n\nexport default async function MisTurnosPage() {\n    const sessionCookie = cookies().get('__session')?.value || '';\n    const userId = await getUserIdFromSession(sessionCookie);\n\n    if (!userId) {\n        redirect('/login');\n    }\n\n    const turnos = await getUserTurnos(userId);\n\n    return (\n        <PrivateRoute>\n            <main className=\"min-h-screen bg-gray-50\">\n                <div className=\"container mx-auto px-4 py-12\">\n                    <h1 className=\"text-4xl font-extrabold text-center mb-10 text-gray-800\">Mis Turnos Solicitados</h1>\n\n                    {turnos.length === 0 ? (\n                        <div className=\"text-center bg-white p-10 rounded-lg shadow-md\">\n                            <p className=\"text-gray-600 text-lg\">Aún no has solicitado ningún turno.</p>\n                            <a href=\"/turnos/peluqueria\" className=\"mt-6 inline-block bg-violet-600 text-white font-semibold py-3 px-6 rounded-full hover:bg-violet-700 transition-colors\">\n                                Solicitar un Turno\n                            </a>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-6\">\n                            {turnos.map(turno => (\n                                <div key={turno.id} className=\"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 flex flex-col md:flex-row justify-between items-start\">\n                                    <div className=\"flex-grow mb-4 md:mb-0\">\n                                        <div className=\"flex items-center mb-3\">\n                                            <h2 className=\"text-xl font-bold text-gray-900 mr-4\">{turno.mascotaNombre}</h2>\n                                            <EstadoBadge estado={turno.estado} />\n                                        </div>\n                                        <div className=\"text-sm text-gray-600 space-y-2\">\n                                            <p className=\"flex items-center\"><FiCalendar className=\"mr-2 text-violet-500\" /> {turno.fechaFormateada}</p>\n                                            <p className=\"flex items-center capitalize\">\n                                                {turno.turno === 'manana' ? <FiSun className=\"mr-2 text-yellow-500\"/> : <FiMoon className=\"mr-2 text-blue-500\"/>} \n                                                Turno {turno.turno}\n                                            </p>\n                                            {turno.servicios && turno.servicios.length > 0 && (\n                                                <p className=\"flex items-center capitalize\">\n                                                    <FiScissors className=\"mr-2 text-gray-500\"/> \n                                                    Servicios: {turno.servicios.join(', ')}\n                                                </p>\n                                            )}\n                                        </div>\n                                    </div>\n                                    {/* Aquí se podrían agregar botones de acción como \"Cancelar Turno\" */}\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n            </main>\n            <Footer />\n        </PrivateRoute>\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}
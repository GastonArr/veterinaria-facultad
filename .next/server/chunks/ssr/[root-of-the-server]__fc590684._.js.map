{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/lib/firebaseConfig.js"],"sourcesContent":["export const firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};"],"names":[],"mappings":";;;;AAAO,MAAM,iBAAiB;IAC5B,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP","debugId":null}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/lib/firebaseAdmin.js"],"sourcesContent":["import admin from 'firebase-admin';\nimport { firebaseConfig } from './firebaseConfig';\n\nconst privateKey = process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g, '\\n');\n\nif (!admin.apps.length) {\n  try {\n    admin.initializeApp({\n      credential: admin.credential.cert({\n        projectId: firebaseConfig.projectId,\n        clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\n        privateKey,\n      }),\n      databaseURL: `https://${firebaseConfig.projectId}.firebaseio.com`\n    });\n  } catch (error) {\n    console.error('Firebase admin initialization error', error);\n  }\n}\n\nexport default admin;"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,oBAAoB,EAAE,QAAQ,OAAO;AAEpE,IAAI,CAAC,sIAAK,CAAC,IAAI,CAAC,MAAM,EAAE;IACtB,IAAI;QACF,sIAAK,CAAC,aAAa,CAAC;YAClB,YAAY,sIAAK,CAAC,UAAU,CAAC,IAAI,CAAC;gBAChC,WAAW,8IAAc,CAAC,SAAS;gBACnC,aAAa,QAAQ,GAAG,CAAC,qBAAqB;gBAC9C;YACF;YACA,aAAa,CAAC,QAAQ,EAAE,8IAAc,CAAC,SAAS,CAAC,eAAe,CAAC;QACnE;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;IACvD;AACF;uCAEe,sIAAK","debugId":null}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/actions/mascotasActions.js"],"sourcesContent":["\n'use server';\n\nimport { revalidatePath } from 'next/cache';\nimport admin from '@/lib/firebaseAdmin';\n\nconst firestore = admin.firestore();\n\nexport async function registrarMascota(user, mascotaData) {\n  if (!user || !user.uid) {\n    return { success: false, error: 'Usuario no autenticado.' };\n  }\n\n  const { nombre, especie, fechaNacimiento, sexo, enAdopcion } = mascotaData;\n  if (!nombre || !especie || !fechaNacimiento || !sexo) {\n    return { success: false, error: 'Faltan datos obligatorios de la mascota.' };\n  }\n\n  try {\n    const mascotasCollection = firestore.collection('users').doc(user.uid).collection('mascotas');\n    \n    const nuevaMascota = {\n      ...mascotaData,\n      enAdopcion: enAdopcion || false,\n      fechaNacimiento: new Date(fechaNacimiento),\n      fechaRegistro: admin.firestore.FieldValue.serverTimestamp(),\n      ownerId: user.uid, // Guardamos referencia al dueño\n    };\n\n    // Guardamos la mascota en la subcolección del usuario\n    const mascotaRef = await mascotasCollection.add(nuevaMascota);\n\n    // --- Estrategia de Desnormalización ---\n    if (nuevaMascota.enAdopcion) {\n      // Si está en adopción, creamos una copia en la colección principal `adopciones`\n      const adopcionDoc = {\n        ...nuevaMascota,\n        mascotaId: mascotaRef.id, // Guardamos el ID original para referencia\n        ownerName: user.displayName || 'Anónimo',\n        ownerEmail: user.email,\n      };\n      // Usamos el mismo ID para facilitar la sincronización y eliminación\n      await firestore.collection('adopciones').doc(mascotaRef.id).set(adopcionDoc);\n    }\n\n    // Revalidamos las páginas para que los cambios se reflejen\n    revalidatePath('/mascotas');\n    if (enAdopcion) {\n        revalidatePath('/adopciones');\n    }\n\n    return { success: true };\n\n  } catch (error) {\n    console.error('Error al registrar la mascota:', error);\n    return { success: false, error: 'Ocurrió un error en el servidor al registrar la mascota.' };\n  }\n}\n"],"names":[],"mappings":";;;;;;AAGA;AACA;;;;;;AAEA,MAAM,YAAY,sIAAK,CAAC,SAAS;AAE1B,eAAe,iBAAiB,IAAI,EAAE,WAAW;IACtD,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,EAAE;QACtB,OAAO;YAAE,SAAS;YAAO,OAAO;QAA0B;IAC5D;IAEA,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,UAAU,EAAE,GAAG;IAC/D,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,mBAAmB,CAAC,MAAM;QACpD,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2C;IAC7E;IAEA,IAAI;QACF,MAAM,qBAAqB,UAAU,UAAU,CAAC,SAAS,GAAG,CAAC,KAAK,GAAG,EAAE,UAAU,CAAC;QAElF,MAAM,eAAe;YACnB,GAAG,WAAW;YACd,YAAY,cAAc;YAC1B,iBAAiB,IAAI,KAAK;YAC1B,eAAe,sIAAK,CAAC,SAAS,CAAC,UAAU,CAAC,eAAe;YACzD,SAAS,KAAK,GAAG;QACnB;QAEA,sDAAsD;QACtD,MAAM,aAAa,MAAM,mBAAmB,GAAG,CAAC;QAEhD,yCAAyC;QACzC,IAAI,aAAa,UAAU,EAAE;YAC3B,gFAAgF;YAChF,MAAM,cAAc;gBAClB,GAAG,YAAY;gBACf,WAAW,WAAW,EAAE;gBACxB,WAAW,KAAK,WAAW,IAAI;gBAC/B,YAAY,KAAK,KAAK;YACxB;YACA,oEAAoE;YACpE,MAAM,UAAU,UAAU,CAAC,cAAc,GAAG,CAAC,WAAW,EAAE,EAAE,GAAG,CAAC;QAClE;QAEA,2DAA2D;QAC3D,IAAA,+IAAc,EAAC;QACf,IAAI,YAAY;YACZ,IAAA,+IAAc,EAAC;QACnB;QAEA,OAAO;YAAE,SAAS;QAAK;IAEzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2D;IAC7F;AACF;;;IAjDsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/.next-internal/server/app/mascotas/nueva/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {registrarMascota as '60e079242676c3da4e738cd129e80ac36ea3879167'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/mascotas/nueva/page.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/mascotas/nueva/page.js <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/mascotas/nueva/page.js <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkS,GAC/T,gEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///home/user/veterinariamagali/src/app/mascotas/nueva/page.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/mascotas/nueva/page.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/mascotas/nueva/page.js\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA8Q,GAC3S,4CACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}